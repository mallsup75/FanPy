version: 2

sources:
  - name: copeland_seeds
#    database: dbt-tutorial          # GCP project ID
    schema: dbt_mallsup             # BigQuery dataset name
    description: Raw source data from copeland to be put in star model
    tables:
      - name: copeland_transactionaldata
        description: Raw transactional for ETL pipeline design focus
      - name: copeland_customer_crm
        description: Data sourced from CRM for MDM
      - name: copeland_customer_erp
        description: Data sourced from ERP for MDM
      - name: copeland_customer_ecomm
        description: Data sourced from Ecommerce platform for MDM       
      - name: copeland_wide
        description: a source provided in order to imagine a new datawarehouse off this source. Also imagine what and why could be added.
models:
  - name: stg_event_company
    description: Staging table for event and company ID combinations extracted from copeland_seeds.copeland_wide companies JSON.
    config:
      materialized: incremental
      unique_key: event_company_id
      schema: copeland_schema
    columns:
      - name: eventuhub_id
        description: Unique identifier for the event.
        tests:
          - not_null
      - name: companyid
        description: Company ID extracted from the companies JSON array.
        tests:
          - not_null
      - name: event_company_id
        description: Composite key combining eventuhub_id and companyid.
        tests:
          - not_null
          - unique
      - name: logged
        description: Timestamp when the event was logged, cast from DATETIME.
        tests:
          - not_null
